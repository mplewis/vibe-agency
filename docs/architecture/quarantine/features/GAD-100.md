# GAD-100: Planning & Research Framework

**Status:** ✅ IMPLEMENTED (Migrated from GAD-001 + GAD-003)
**Date:** 2025-11-17
**Pillar:** GAD-1XX (Planning & Research)
**Priority:** P0 (Core SDLC framework)

---

## Executive Summary

**Pillar 1 (GAD-1XX)** encompasses the Planning Framework and Research capabilities - the first phase of the SDLC workflow that transforms user ideas into validated, architected project specifications.

**Components:**
1. **Planning Framework** (SDLC Phase 1)
2. **Research Sub-Framework** (capability module within Planning)
3. **Phase 3 Additions** (VibeConfig, handoff automation)

**Historical Context:**
- **GAD-001 (2025-11-14):** Research Framework Integration
- **GAD-003 (2025-11-14):** Research Capability Restoration
- **GAD-100 Phases 1-3 (2025-11-16/17):** VibeConfig wrapper, schemas, integration

---

## Architecture

### Planning Framework Structure

```
agency_os/01_planning_framework/
├── agents/
│   ├── LEAN_CANVAS_VALIDATOR/      # Business validation
│   ├── VIBE_ALIGNER/                # Feature extraction & alignment
│   ├── GENESIS_BLUEPRINT/           # Architecture design
│   └── research/                    # Research sub-framework (GAD-001)
│       ├── MARKET_RESEARCHER/
│       ├── TECH_RESEARCHER/
│       ├── FACT_VALIDATOR/
│       └── USER_RESEARCHER/
├── knowledge/
│   ├── FAE_constraints.yaml         # Existing (736 lines)
│   ├── FDG_dependencies.yaml        # Existing (2546 lines)
│   ├── APCE_rules.yaml              # Existing (1304 lines)
│   └── PROJECT_TEMPLATES.yaml       # Existing
└── state_machine/                   # Workflow definitions
    └── planning_workflow_design.yaml
```

---

## Key Decisions

### Decision 1: Research is a Capability Module (Not a Lifecycle State)

**Choice:** Research belongs WITHIN Planning (01_planning_framework/research/)
**Rationale:** Research is NOT a separate SDLC phase - it's a capability used DURING planning
**Impact:** No separate research framework number (e.g., no "02_research_framework/")

**From GAD-001:**
> Research is a CAPABILITY MODULE, not a LIFECYCLE STATE
> → Research belongs IN 01_planning_framework/, NOT as separate numbered framework

### Decision 2: Sub-Framework Pattern

**Choice:** Research has its own directory, agents, knowledge within Planning
**Rationale:** Large enough to warrant subsystem organization, but still part of Planning scope
**Impact:** `01_planning_framework/research/` with 4 agents

### Decision 3: Monorepo Integration

**Choice:** Integrate vibe-research prototype directly into vibe-agency
**Rationale:** Simpler for MVP, can extract later as package/submodule if needed
**Impact:** All research code lives in main repo

---

## Implementation Status

### ✅ Implemented (GAD-001 + GAD-003)

**Research Agents:**
- ✅ MARKET_RESEARCHER - Market analysis, competitor research
- ✅ TECH_RESEARCHER - Technology stack validation
- ✅ FACT_VALIDATOR - Claim verification
- ✅ USER_RESEARCHER - User research (no tools needed)

**Research Knowledge:**
- ✅ Market sizing formulas
- ✅ Competitor analysis templates
- ✅ Research constraints
- ✅ Persona templates
- ✅ Interview question bank
- ✅ Red flag taxonomy

**Verification:**
```bash
ls -la agency_os/01_planning_framework/agents/research/
wc -l agency_os/01_planning_framework/knowledge/*.yaml
```

### ✅ Implemented (GAD-100 Phase 3)

**Phoenix Config Integration:**
- ✅ `lib/phoenix_config/` - Vendored config library
- ✅ `lib/vibe_config.py` - Vibe-specific wrapper
- ✅ `config/vibe_config.py` - Production config layer
- ✅ Automated session handoff creation
- ✅ VibeConfig integrated into orchestrator

**Verification:**
```bash
ls -la lib/phoenix_config/
uv run pytest tests/test_lib_module/ -v
uv run pytest tests/test_orchestrator_vibe_config.py -v
```

### ✅ Implemented (GAD-100 + GAD-5: Zero-Config Boot Protocol)

**Date:** 2025-11-18 (PR #158)

**The Zero-Config Boot Protocol** enables automatic configuration loading without manual setup:

**Auto-Loading .env Files:**
- ✅ `python-dotenv` integration in `agency_os/config/phoenix.py:44-51`
- ✅ Automatic .env file discovery and loading
- ✅ Environment variables available before config initialization
- ✅ No manual `load_dotenv()` calls required in application code

**Auto-Provisioning:**
- ✅ .env file auto-created from .env.example template (if missing)
- ✅ Safe defaults for all configuration values
- ✅ Graceful degradation (NoOp mode) when API keys absent

**Implementation:**
```python
# agency_os/config/phoenix.py

from dotenv import load_dotenv

# GAD-5: Auto-load .env files (Zero-Config Boot)
# This ensures environment variables are available before any config is created
load_dotenv()

class PhoenixConfig(BaseSettings):
    class Config:
        env_file = ".env"
        env_file_encoding = "utf-8"
        case_sensitive = False
        extra = "ignore"  # GAD-5: Ignore unknown env vars for robustness
```

**Impact:**
- Developers can start immediately without manual configuration
- System runs in knowledge-only mode (NoOp provider) without API keys
- Production deployments auto-load from .env or environment variables

**Related GADs:**
- **GAD-509:** Circuit Breaker Protocol
- **GAD-510:** Quota Manager (uses VIBE_QUOTA_* env vars)
- **GAD-511:** Neural Adapter Strategy (auto-detects provider from API keys)

**Verification:**
```bash
# Check .env auto-loading
grep -n "load_dotenv" agency_os/config/phoenix.py

# Test configuration loading
uv run python -c "from agency_os.config import get_config; print(get_config().to_dict())"

# Verify NoOp fallback (no API keys)
unset GOOGLE_API_KEY ANTHROPIC_API_KEY OPENAI_API_KEY
uv run python -c "from agency_os.00_system.runtime.providers import get_default_provider; print(get_default_provider().get_provider_name())"
# Expected output: "NoOp"
```

### ⚠️ Partially Implemented (GAD-003 - Research Tools)

**Status:** Research agents exist but have NO active tools
**Issue:** Tool-Prompt Mismatch (prompts reference tools that don't exist)

**Missing Tools:**
- `google_search` (Google Search API)
- `crunchbase_lookup` (Crunchbase API)
- `producthunt_search` (ProductHunt API)

**Current State:** Agents are "passive validators" (read YAML only)
**Target State:** "Active researchers" (query external APIs)

**Decision:** Deferred until after GAD-100 Phase 3
**Rationale:** Higher priority work (schemas, automation) completed first

---

## GAD-100 Phase Completion Status

### ✅ Phase 1: Phoenix Config Vendoring (COMPLETE)
**Date:** 2025-11-16
**Deliverables:**
- lib/phoenix_config/ vendored (1800+ lines)
- Import path fixes (tests updated)
- Zero regressions (all existing tests pass)

### ✅ Phase 2: Canonical Schema Definition (COMPLETE)
**Date:** 2025-11-17
**Deliverables:**
- config/schemas/project_manifest.schema.json (268 lines)
- config/schemas/session_handoff.schema.json (92 lines)
- tests/test_canonical_schemas.py (389 lines, 14/14 passing)
- Validates ALL 7 existing project manifests successfully

### ✅ Phase 3: VibeConfig Integration (COMPLETE)
**Date:** 2025-11-17
**Deliverables:**
- lib/vibe_config.py (VibeConfig core API)
- config/vibe_config.py (Production wrapper)
- Automated session handoff creation
- Orchestrator integration
- 12/12 tests passing (Phase 3.3)

### ⏸️ Phase 4-6: DEFERRED

**Deferred Components:**
- Phase 4: Feature flags (circuit breakers, gradual rollout)
- Phase 5: Migration tools (state file migration)
- Phase 6: Advanced configuration (multi-environment)

**Rationale:** Phases 1-3 deliver immediate value, Phases 4-6 are invasive and lower priority

**See:** `docs/architecture/GAD-1XX/GAD-100_PHASE_COMPLETION.md` for detailed completion report

---

## Current State (As of 2025-11-17)

### Working Components

**Planning Workflow:**
```bash
# Test planning workflow end-to-end
uv run pytest tests/test_planning_workflow.py -v
# Result: ✅ PASSES (planning workflow validated)
```

**File-Based Delegation:**
```bash
# Test file-based delegation (GAD-003 pattern)
uv run python manual_planning_test.py
# Result: ✅ Works (handoff.json created successfully)
```

**VibeConfig:**
```bash
# Test VibeConfig API
uv run pytest tests/test_lib_module/test_vibe_config.py -v
# Result: ✅ PASSES (Phase 3 integration complete)
```

**Canonical Schemas:**
```bash
# Test schema validation
uv run pytest tests/test_canonical_schemas.py -v
# Result: ✅ 14/14 tests passing (Phase 2 complete)
```

### Known Issues

**1. Research Tools Not Active (GAD-003 Deferred)**
- Research agents have prompts referencing tools they don't have
- Currently passive validators (YAML readers) instead of active researchers
- Fix: Implement tool integrations (Google Search, Crunchbase, ProductHunt)
- Status: Deferred (not blocking MVP)

**2. Import Path Complexity (Minor)**
- Some tests use complex import paths due to phoenix_config vendoring
- Works correctly but could be simplified
- Fix: Potential refactor in future cleanup phase

---

## Verification Commands

```bash
# Planning Framework structure
ls -la agency_os/01_planning_framework/agents/
ls -la agency_os/01_planning_framework/agents/research/

# Knowledge bases
wc -l agency_os/01_planning_framework/knowledge/*.yaml

# Tests
uv run pytest tests/test_planning_workflow.py -v
uv run pytest tests/test_file_based_delegation.py -v
uv run pytest tests/test_canonical_schemas.py -v
uv run pytest tests/test_lib_module/test_vibe_config.py -v

# Manual E2E test
uv run python manual_planning_test.py
cat workspaces/manual-test-project/handoff.json
```

---

## Sub-Documents (GAD-1XX Series)

- **GAD-100:** This document (Planning & Research EPIC)
- **GAD-101:** Research Agent Tool Integration (Planned - implements GAD-003 tools)
- **GAD-102:** Planning Workflow Optimization (Planned)
- **GAD-103:** Project Templates System (Planned)

---

## Cross-Pillar Dependencies

**GAD-1XX depends on:**
- **GAD-2XX (Orchestration):** Core orchestrator invokes planning handlers
- **GAD-3XX (Agent Framework):** Agents use prompt runtime
- **GAD-6XX (Knowledge):** Planning agents query knowledge department
- **GAD-7XX (STEWARD):** AUDITOR validates planning outputs

**Other pillars depend on GAD-1XX:**
- **GAD-2XX (Orchestration):** Planning is first SDLC phase
- **GAD-4XX (Quality):** Quality gates validate planning artifacts

---

## Migration Notes

**Migrated from:**
- GAD-001: Research Framework Integration
- GAD-003: Research Capability Restoration
- GAD-100 internal phases (phoenix_config, schemas, VibeConfig)

**Files archived:**
- docs/architecture/archive/pre-migration/GAD-001_Research_Integration.md
- docs/architecture/archive/pre-migration/GAD-003_Research_Capability_Restoration.md

**References updated:**
- ARCHITECTURE_MAP.md: GAD-001 → GAD-1XX
- INDEX.md: GAD-1XX pillar defined

---

**Last Updated:** 2025-11-17
**Next Review:** After Research Tools implemented (GAD-101)
**Maintainer:** Architecture Team
